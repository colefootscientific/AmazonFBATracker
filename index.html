<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Packing Tracker</title>
  <style>
    body {
      background-color: #000000;
      color: #57B6FF;
      font-family: Helvetica, sans-serif;
      text-align: center;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background-color: #1a1a1a;
      padding: 20px;
      border-radius: 12px;
    }
    h1, h2, h3 {
      color: #57B6FF;
    }
    form, .items-area, .finish-area {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin: 10px 0 5px;
      text-align: left;
    }
    input {
      width: 100%;
      max-width: 400px;
      padding: 10px;
      margin: 5px auto 15px;
      border: 1px solid #57B6FF;
      border-radius: 6px;
      background: #000;
      color: #57B6FF;
      font-size: 16px;
      display: block;
    }
    button {
      background-color: #57B6FF;
      border: none;
      color: #000;
      padding: 12px 20px;
      margin: 10px 5px;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      font-size: 16px;
      min-width: 120px;
    }
    button:hover {
      background-color: #3a8edc;
      color: #fff;
    }
    .table-container {
      overflow-x: auto;
      margin-top: 20px;
    }
    table {
      width: 100%;
      min-width: 600px;
      border-collapse: collapse;
      background: #1a1a1a;
    }
    th, td {
      border: 1px solid #57B6FF;
      padding: 12px;
      text-align: center;
      font-size: 16px;
    }
    th {
      background: #000;
      color: #57B6FF;
    }
    #summary {
      margin-top: 20px;
      font-weight: bold;
      font-size: 18px;
    }
    #skuSummary {
      margin-top: 20px;
      background: #000;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #57B6FF;
      text-align: left;
    }
    img.logo {
      max-width: 220px;
      margin-bottom: 20px;
    }
    /* ðŸ“± Responsive */
    @media (max-width: 768px) {
      body { padding: 10px; }
      .container { padding: 15px; }
      input { font-size: 18px; }
      button { font-size: 18px; width: 100%; max-width: none; }
      table { font-size: 14px; }
    }
  </style>
</head>
<body>

  <img src="static/footscientificlogo.png" alt="Logo" class="logo" />

  <div class="container">
    <h1>Packing Tracker</h1>

    <!-- Step 1: Box ID -->
    <form id="boxForm">
      <h2>New Box</h2>
      <label>Box ID:</label>
      <input type="text" id="boxId" required>
      <button type="submit">Start Box</button>
    </form>

    <!-- Step 2: Items -->
    <div id="itemSection" class="items-area" style="display:none;">
      <h2>Add Items to Box: <span id="currentBoxId"></span></h2>
      <label>SKU:</label>
      <input type="text" id="sku" placeholder="e.g., 201-04">
      <label>Quantity:</label>
      <input type="number" id="qty">
      <button id="addItemBtn">Add Item</button>
      <button id="finishBoxBtn">Finish Box</button>

      <!-- Live preview area with edit/remove -->
      <div id="currentItemsPreview" style="margin-top:20px; text-align:left;">
        <h3>Current Items in Box:</h3>
        <ul id="currentItemsList"></ul>
      </div>
    </div>

    <!-- Step 3: Dimensions + Weight -->
    <div id="finishSection" class="finish-area" style="display:none;">
      <h2>Enter Dimensions & Weight</h2>
      <label>Length:</label>
      <input type="number" id="length">
      <label>Width:</label>
      <input type="number" id="width">
      <label>Height:</label>
      <input type="number" id="height">
      <label>Weight (lbs):</label>
      <input type="number" id="weight" step="0.1">
      <button id="saveBoxBtn">Save Box</button>
    </div>

    <div class="table-container">
      <table id="boxTable">
        <thead>
          <tr>
            <th>Box ID</th>
            <th>Dimensions (LxWxH)</th>
            <th>Weight</th>
            <th>Items</th>
            <th>Total Items in Box</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div id="summary">TOTAL ITEMS PACKED: 0</div>
    <div id="skuSummary"></div>

    <button id="clearAllBtn" style="background:#ff4444; color:white; margin-top:20px; display:none;">
      Clear All
    </button>
  </div>

<script>
  const boxForm = document.getElementById('boxForm');
  const itemSection = document.getElementById('itemSection');
  const finishSection = document.getElementById('finishSection');
  const currentBoxIdSpan = document.getElementById('currentBoxId');
  const boxTableBody = document.querySelector('#boxTable tbody');
  const summary = document.getElementById('summary');
  const skuSummary = document.getElementById('skuSummary');
  const clearAllBtn = document.getElementById('clearAllBtn');
  const currentItemsList = document.getElementById('currentItemsList');

  let currentBox = null;
  let boxes = [];
  let totalPacked = 0;

  // Step 1: Start box with ID
  boxForm.addEventListener('submit', function(e) {
    e.preventDefault();
    currentBox = { id: document.getElementById('boxId').value, items: [] };
    currentBoxIdSpan.textContent = currentBox.id;
    itemSection.style.display = 'block';
    finishSection.style.display = 'none';
    currentItemsList.innerHTML = '';
    boxForm.reset();
  });

  // SKU Validation
  function isValidSKU(sku) {
    const regex = /^(201|202|203|100|101)-\S+$/;
    return regex.test(sku);
  }

  // Update live preview of items with edit/remove
  function updateCurrentItemsPreview() {
    currentItemsList.innerHTML = '';
    currentBox.items.forEach((item, index) => {
      const li = document.createElement('li');
      li.textContent = `${item.sku} (${item.qty}) `;

      // Edit button
      const editBtn = document.createElement('button');
      editBtn.textContent = "Edit";
      editBtn.style.marginLeft = "10px";
      editBtn.addEventListener('click', () => {
        const newQty = prompt(`Enter new quantity for ${item.sku}:`, item.qty);
        if (newQty !== null && !isNaN(newQty) && newQty > 0) {
          totalPacked -= item.qty;
          item.qty = parseInt(newQty, 10);
          totalPacked += item.qty;
          summary.textContent = `TOTAL ITEMS PACKED: ${totalPacked}`;
          updateCurrentItemsPreview();
        }
      });

      // Remove button
      const removeBtn = document.createElement('button');
      removeBtn.textContent = "Remove";
      removeBtn.style.marginLeft = "5px";
      removeBtn.addEventListener('click', () => {
        totalPacked -= item.qty;
        currentBox.items.splice(index, 1);
        summary.textContent = `TOTAL ITEMS PACKED: ${totalPacked}`;
        updateCurrentItemsPreview();
      });

      li.appendChild(editBtn);
      li.appendChild(removeBtn);
      currentItemsList.appendChild(li);
    });
  }

  // Step 2: Add items
  document.getElementById('addItemBtn').addEventListener('click', function() {
    const sku = document.getElementById('sku').value.trim();
    const qty = parseInt(document.getElementById('qty').value, 10);

    if (!sku || !qty) return alert("Please enter both SKU and quantity.");

    if (!isValidSKU(sku)) {
      alert("Invalid SKU! Only SKUs starting with 100-, 101-, 201-, 202-, or 203- are allowed.");
      return;
    }

    currentBox.items.push({ sku, qty });
    totalPacked += qty;
    summary.textContent = `TOTAL ITEMS PACKED: ${totalPacked}`;
    updateCurrentItemsPreview();
    document.getElementById('sku').value = '';
    document.getElementById('qty').value = '';
  });

  // Show dimension/weight fields
  document.getElementById('finishBoxBtn').addEventListener('click', function() {
    if (!currentBox) return;
    itemSection.style.display = 'none';
    finishSection.style.display = 'block';
    currentItemsList.innerHTML = '';
  });

  // Step 3: Save box after entering dimensions/weight
  document.getElementById('saveBoxBtn').addEventListener('click', function() {
    if (!currentBox) return;

    currentBox.length = document.getElementById('length').value || 0;
    currentBox.width = document.getElementById('width').value || 0;
    currentBox.height = document.getElementById('height').value || 0;
    currentBox.weight = document.getElementById('weight').value || 0;

    boxes.push(currentBox);

    renderTable();
    updateSkuSummary();

    clearAllBtn.style.display = 'inline-block';

    // reset for next box
    currentBox = null;
    finishSection.style.display = 'none';
    itemSection.style.display = 'none';
    document.getElementById('length').value = '';
    document.getElementById('width').value = '';
    document.getElementById('height').value = '';
    document.getElementById('weight').value = '';
  });

  function renderTable() {
    boxTableBody.innerHTML = '';
    boxes.forEach((box, index) => {
      const totalInBox = box.items.reduce((sum, i) => sum + i.qty, 0);
      const itemsList = box.items.map(i => `${i.sku} (${i.qty})`).join(', ');

      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${box.id}</td>
        <td>${box.length} x ${box.width} x ${box.height}</td>
        <td>${parseFloat(box.weight).toFixed(1)} lbs</td>
        <td>${itemsList}</td>
        <td>${totalInBox}</td>
        <td><button class="editBtn">Edit</button></td>
      `;

      row.querySelector('.editBtn').addEventListener('click', function() {
        editBox(index);
      });

      boxTableBody.appendChild(row);
    });
  }

  function editBox(index) {
    currentBox = boxes[index];
    boxes.splice(index, 1); // remove old version

    document.getElementById('boxId').value = currentBox.id;
    document.getElementById('length').value = currentBox.length;
    document.getElementById('width').value = currentBox.width;
    document.getElementById('height').value = currentBox.height;
    document.getElementById('weight').value = currentBox.weight;

    currentBoxIdSpan.textContent = currentBox.id;
    itemSection.style.display = 'block';
    finishSection.style.display = 'block';
    updateCurrentItemsPreview();

    renderTable();
    updateSkuSummary();
  }

  function updateSkuSummary() {
    let skuTotals = {};
    boxes.forEach(box => {
      box.items.forEach(item => {
        if (!skuTotals[item.sku]) skuTotals[item.sku] = 0;
        skuTotals[item.sku] += item.qty;
      });
    });

    let summaryHtml = "<h3>SKU Totals:</h3><ul>";
    for (let sku in skuTotals) {
      summaryHtml += `<li>${sku}: ${skuTotals[sku]}</li>`;
    }
    summaryHtml += "</ul>";
    skuSummary.innerHTML = summaryHtml;
  }

  // Clear all
  clearAllBtn.addEventListener('click', function() {
    if (!confirm("Are you sure you want to clear everything and restart?")) return;
    boxes = [];
    currentBox = null;
    totalPacked = 0;
    boxTableBody.innerHTML = '';
    summary.textContent = "TOTAL ITEMS PACKED: 0";
    skuSummary.innerHTML = '';
    itemSection.style.display = 'none';
    finishSection.style.display = 'none';
    boxForm.reset();
    clearAllBtn.style.display = 'none';
  });
</script>

</body>
</html>




